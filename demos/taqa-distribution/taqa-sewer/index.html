<!DOCTYPE html>
<html lang="en">
<head>
<meta name="robots" content="noindex, nofollow">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nexus Intelligence ‚Äî Municipal Stormwater POC</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåä</text></svg>">
<link rel="stylesheet" href="https://js.arcgis.com/4.28/esri/themes/dark/main.css">
<script src="https://js.arcgis.com/4.28/"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js"></script>
<style>
:root{--bg:#070d14;--bg2:#0f1a2e;--bg3:#162038;--brd:rgba(255,255,255,.06);--t1:#e8edf5;--t2:#8b9dc3;--tm:#5a6f94;--blue:#2d8cf0;--red:#e54d4d;--amb:#e8a838;--grn:#2ecb71;--teal:#1abc9c;--purp:#9b59b6}
@import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--t1);height:100vh;overflow:hidden}
.app{display:grid;grid-template-columns:1fr 420px;height:100vh}
.map-panel{position:relative;overflow:hidden}
#viewDiv{width:100%;height:100%}
.map-overlay-top{position:absolute;top:16px;left:16px;z-index:10}
.brand{display:flex;align-items:center;gap:10px;background:rgba(7,13,20,.92);backdrop-filter:blur(12px);padding:10px 16px;border-radius:10px;border:1px solid var(--brd)}
.brand-icon{width:32px;height:32px;background:linear-gradient(135deg,var(--blue),var(--teal));border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:16px;color:#fff}
.brand-text{font-size:14px;font-weight:600}.brand-sub{font-size:10px;color:var(--tm);letter-spacing:1px;text-transform:uppercase}
.sidebar{position:absolute;top:16px;right:436px;z-index:10;display:flex;flex-direction:column;gap:8px}
.sc{background:rgba(7,13,20,.92);backdrop-filter:blur(12px);padding:12px 16px;border-radius:10px;border:1px solid var(--brd);min-width:180px}
.sc-l{font-size:9px;text-transform:uppercase;letter-spacing:1.5px;color:var(--tm)}
.sc-v{font-size:22px;font-weight:700;margin-top:2px}
.sc-d{font-size:10px;color:var(--tm);margin-top:2px}
.red{color:var(--red)}.amb{color:var(--amb)}.grn{color:var(--grn)}.blue{color:var(--blue)}
.legend{position:absolute;bottom:16px;left:16px;z-index:10;background:rgba(7,13,20,.92);backdrop-filter:blur(12px);padding:14px 18px;border-radius:10px;border:1px solid var(--brd)}
.lg-t{font-size:10px;text-transform:uppercase;letter-spacing:1.5px;color:var(--tm);margin-bottom:10px}
.lg-i{display:flex;align-items:center;gap:8px;margin-bottom:6px;font-size:11px;color:var(--t2)}
.lg-d{width:10px;height:10px;border-radius:50%;flex-shrink:0}
.chat-panel{display:flex;flex-direction:column;background:var(--bg2);border-left:1px solid var(--brd);height:100vh}
.ch{padding:14px 18px;border-bottom:1px solid var(--brd);display:flex;align-items:center;gap:12px}
.ch-i{width:36px;height:36px;background:linear-gradient(135deg,var(--blue),var(--teal));border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px;color:#fff}
.ch-t{font-size:14px;font-weight:600}.ch-s{font-size:10px;color:var(--tm)}
.ab{display:flex;align-items:center;gap:8px;padding:8px 18px;background:rgba(229,77,77,.08);border-bottom:1px solid rgba(229,77,77,.15)}
.ab-p{width:8px;height:8px;border-radius:50%;background:var(--red);animation:p 2s infinite}
@keyframes p{0%,100%{opacity:1}50%{opacity:.4}}
.ab-t{font-size:11px;font-weight:500;color:var(--red);flex:1}
.kr{display:flex;gap:6px;padding:10px 18px;border-bottom:1px solid var(--brd);overflow-x:auto}
.ki{background:var(--bg3);padding:8px 10px;border-radius:8px;text-align:center;flex:1;min-width:70px}
.ki-l{font-size:8px;text-transform:uppercase;letter-spacing:1px;color:var(--tm)}
.ki-v{font-size:13px;font-weight:700;margin-top:2px}
.msgs{flex:1;overflow-y:auto;padding:14px 18px;scroll-behavior:smooth}
.msg{margin-bottom:14px}.msg.u{text-align:right}
.mb{display:inline-block;max-width:92%;padding:10px 14px;border-radius:12px;font-size:12.5px;line-height:1.55;text-align:left}
.msg.a .mb{background:var(--bg3);border:1px solid var(--brd)}
.msg.u .mb{background:var(--blue);color:#fff;font-weight:500}
.vb{margin:10px 0;padding:10px;background:rgba(0,0,0,.2);border-radius:8px;border:1px solid var(--brd)}
.vt{font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--teal);margin-bottom:8px}
.vr{display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px solid rgba(255,255,255,.04);font-size:11px}
.vr:last-child{border:none}.vr .l{color:var(--t2)}.vr .v{font-weight:600}
.vtbl{width:100%;border-collapse:collapse;font-size:10.5px;margin-top:6px}
.vtbl th{text-align:left;padding:4px 6px;color:var(--tm);font-weight:500;border-bottom:1px solid var(--brd);font-size:9px;text-transform:uppercase}
.vtbl td{padding:4px 6px;border-bottom:1px solid rgba(255,255,255,.03);color:var(--t2)}
.vtbl td.hl{color:var(--t1);font-weight:600}
.trace{display:flex;align-items:center;gap:4px;padding:8px;background:rgba(26,188,156,.05);border-radius:6px;flex-wrap:wrap}
.tn{padding:4px 8px;border-radius:4px;font-size:10px;font-weight:500}
.tn.src{background:rgba(229,77,77,.15);color:var(--red);border:1px solid rgba(229,77,77,.3)}
.tn.mid{background:rgba(232,168,56,.1);color:var(--amb);border:1px solid rgba(232,168,56,.2)}
.tn.end{background:rgba(46,203,113,.1);color:var(--grn);border:1px solid rgba(46,203,113,.2)}
.ta{color:var(--tm);font-size:10px}
.wo{padding:10px;background:rgba(45,140,240,.05);border:1px solid rgba(45,140,240,.15);border-radius:6px}
.wo-h{font-size:11px;font-weight:600;color:var(--blue);margin-bottom:6px}
.wo-f{display:flex;justify-content:space-between;padding:3px 0;font-size:10.5px}
.wo-f .wl{color:var(--tm)}.wo-f .wv{color:var(--t2)}
.prov{margin-top:10px;padding-top:8px;border-top:1px solid var(--brd)}
.prov-l{font-size:8px;text-transform:uppercase;letter-spacing:1px;color:var(--tm);margin-bottom:4px}
.prov-t{display:flex;gap:4px;flex-wrap:wrap}
.pt{font-size:9px;padding:2px 6px;border-radius:3px;background:rgba(255,255,255,.04);color:var(--tm)}
.pt::before{content:"‚úì";color:var(--grn);margin-right:3px;font-size:8px}
.ca{padding:12px 18px;background:var(--bg3);border-top:1px solid var(--brd)}
.ca-l{font-size:9px;text-transform:uppercase;letter-spacing:1px;color:var(--tm);margin-bottom:8px}
.cg{display:flex;flex-wrap:wrap;gap:6px}
.chip{padding:7px 12px;border-radius:8px;border:1px solid var(--brd);background:var(--bg2);color:var(--t2);font-size:11px;cursor:pointer;transition:all .2s;font-family:inherit}
.chip:hover{border-color:var(--blue);color:var(--blue);background:rgba(45,140,240,.05)}
.chip.ov{border-color:rgba(26,188,156,.3);color:var(--teal)}
.ia{display:flex;gap:8px;padding:12px 18px;border-top:1px solid var(--brd)}
.ia input{flex:1;background:var(--bg3);border:1px solid var(--brd);border-radius:8px;padding:10px 14px;color:var(--t1);font-size:12px;font-family:inherit;outline:none}
.ia input:focus{border-color:var(--blue)}
.ia button{background:var(--blue);color:#fff;border:none;border-radius:8px;padding:10px 16px;font-weight:600;font-size:12px;cursor:pointer;font-family:inherit}
.td{display:flex;gap:4px;padding:8px 0}.tdt{width:6px;height:6px;border-radius:50%;background:var(--tm);animation:tb 1.4s infinite}
.tdt:nth-child(2){animation-delay:.2s}.tdt:nth-child(3){animation-delay:.4s}
@keyframes tb{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-6px)}}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);border-radius:4px}
</style>
</head>
<body>
<div class="app">
<div class="map-panel">
<div id="viewDiv"></div>
<div class="map-overlay-top">
<div class="brand"><div class="brand-icon">N</div><div><div class="brand-text">Rebirth Nexus</div><div class="brand-sub">Stormwater & Sewer Intelligence ¬∑ Houston TX</div></div></div>
</div>
<div class="sidebar">
<div class="sc"><div class="sc-l">Flood Exposure</div><div class="sc-v red">$12.4M</div><div class="sc-d">3 catchments critical</div></div>
<div class="sc"><div class="sc-l">System Capacity</div><div class="sc-v red">127%</div><div class="sc-d">Exceeding design limits</div></div>
<div class="sc"><div class="sc-l">SSO Risk</div><div class="sc-v amb">4 locations</div><div class="sc-d">Sanitary Sewer Overflow</div></div>
<div class="sc"><div class="sc-l">Rainfall Rate</div><div class="sc-v blue">3.2 in/hr</div><div class="sc-d">1-hr 100-yr intensity</div></div>
</div>
<div class="legend">
<div class="lg-t">Network Status</div>
<div class="lg-i"><div class="lg-d" style="background:var(--red);box-shadow:0 0 8px rgba(229,77,77,.5)"></div> Overflow / Surcharge</div>
<div class="lg-i"><div class="lg-d" style="background:var(--amb)"></div> Stressed (>85% capacity)</div>
<div class="lg-i"><div class="lg-d" style="background:var(--grn)"></div> Normal Operations</div>
<div class="lg-i"><div class="lg-d" style="background:var(--blue)"></div> Lift Station / Pump</div>
<div class="lg-t" style="margin-top:10px">Infrastructure</div>
<div class="lg-i"><div style="width:18px;height:2px;background:var(--teal);flex-shrink:0"></div> Stormwater Trunk</div>
<div class="lg-i"><div style="width:18px;height:2px;background:var(--purp);flex-shrink:0"></div> Sanitary Sewer Main</div>
</div>
</div>

<div class="chat-panel">
<div class="ch"><div class="ch-i">N</div><div><div class="ch-t">NexusFlow Intelligence</div><div class="ch-s">Stormwater & Sewer Network ¬∑ Harris County</div></div></div>
<div class="ab"><div class="ab-p"></div><div class="ab-t">FLOOD ALERT ‚Äî Houston Metro ¬∑ 3.2 in/hr ¬∑ 1-hr 100-yr Event</div></div>
<div class="kr">
<div class="ki"><div class="ki-l">Exposure</div><div class="ki-v red">$12.4M</div></div>
<div class="ki"><div class="ki-l">Overflow</div><div class="ki-v red">3</div></div>
<div class="ki"><div class="ki-l">SSO Risk</div><div class="ki-v amb">4</div></div>
<div class="ki"><div class="ki-l">Pumps</div><div class="ki-v grn">18/22</div></div>
</div>
<div class="msgs" id="chatMessages"></div>
<div class="ca"><div class="ca-l">Suggested Queries</div><div class="cg" id="chipsGrid"></div></div>
<div class="ia"><input type="text" id="chatInput" placeholder="Ask about sewer & stormwater operations..."><button onclick="handleSend()">Send</button></div>
</div>
</div>

<script>
require(["esri/Map","esri/views/MapView","esri/Graphic","esri/layers/GraphicsLayer","esri/geometry/Point","esri/geometry/Polyline"],
function(Map,MapView,Graphic,GraphicsLayer,Point,Polyline){
const map=new Map({basemap:"dark-gray-vector"});
const view=new MapView({container:"viewDiv",map,center:[-95.37,29.76],zoom:11});
view.ui.remove(["zoom","attribution"]);
const ptLyr=new GraphicsLayer(),lineLyr=new GraphicsLayer();window._ptLyr=ptLyr;window._view=view;
map.addMany([lineLyr,ptLyr]);

const nodes=[
{id:"MH-101",name:"Brays Bayou Trunk MH-101",lat:29.70,lon:-95.40,status:"OVERFLOW",type:"Manhole",cap:127,depth:14.2},
{id:"MH-204",name:"Sims Bayou Interceptor MH-204",lat:29.66,lon:-95.35,status:"OVERFLOW",type:"Manhole",cap:134,depth:16.8},
{id:"MH-312",name:"Buffalo Bayou Junction MH-312",lat:29.76,lon:-95.37,status:"OVERFLOW",type:"Junction",cap:145,depth:18.1},
{id:"LS-01",name:"Westpark Lift Station LS-01",lat:29.72,lon:-95.44,status:"STRESSED",type:"Lift Station",cap:92,depth:0},
{id:"LS-02",name:"Almeda Lift Station LS-02",lat:29.68,lon:-95.38,status:"STRESSED",type:"Lift Station",cap:88,depth:0},
{id:"LS-03",name:"Hobby Airport Lift Station",lat:29.64,lon:-95.28,status:"NORMAL",type:"Lift Station",cap:64,depth:0},
{id:"MH-156",name:"Meyerland Trunk MH-156",lat:29.68,lon:-95.44,status:"STRESSED",type:"Manhole",cap:87,depth:12.4},
{id:"WWTP",name:"69th St WWTP Headworks",lat:29.72,lon:-95.30,status:"STRESSED",type:"WWTP",cap:91,depth:0},
{id:"MH-420",name:"Galleria Area MH-420",lat:29.74,lon:-95.46,status:"NORMAL",type:"Manhole",cap:55,depth:6.2},
{id:"OUT-01",name:"Buffalo Bayou Outfall",lat:29.77,lon:-95.33,status:"NORMAL",type:"Outfall",cap:72,depth:0},
{id:"SSO-1",name:"SSO Risk ‚Äî Bellaire Blvd",lat:29.70,lon:-95.46,status:"SSO_RISK",type:"SSO Point",cap:0,depth:0},
{id:"SSO-2",name:"SSO Risk ‚Äî South Main",lat:29.67,lon:-95.37,status:"SSO_RISK",type:"SSO Point",cap:0,depth:0},
{id:"SSO-3",name:"SSO Risk ‚Äî Telephone Rd",lat:29.69,lon:-95.32,status:"SSO_RISK",type:"SSO Point",cap:0,depth:0},
{id:"SSO-4",name:"SSO Risk ‚Äî Navigation Blvd",lat:29.75,lon:-95.34,status:"SSO_RISK",type:"SSO Point",cap:0,depth:0},
];
const colors={OVERFLOW:[229,77,77],STRESSED:[232,168,56],NORMAL:[46,203,113],SSO_RISK:[155,89,182]};
nodes.forEach(n=>{
const c=colors[n.status]||[100,100,100];
const sz=n.status==="OVERFLOW"?16:n.status==="SSO_RISK"?13:n.type==="Lift Station"||n.type==="WWTP"?14:10;
const sym=n.type==="Lift Station"||n.type==="WWTP"?{type:"simple-marker",color:c,size:sz,style:"diamond",outline:{color:[255,255,255,80],width:1.5}}:{type:"simple-marker",color:c,size:sz,outline:{color:[255,255,255,60],width:1}};
ptLyr.add(new Graphic({geometry:new Point({longitude:n.lon,latitude:n.lat}),symbol:sym,attributes:n}));
});
// Trunk lines
const trunks=[
[[-95.46,29.70],[-95.44,29.70],[-95.40,29.70],[-95.37,29.72],[-95.33,29.77]],
[[-95.44,29.68],[-95.40,29.70]],
[[-95.38,29.66],[-95.37,29.68],[-95.37,29.72]],
[[-95.35,29.66],[-95.32,29.69],[-95.30,29.72]],
[[-95.37,29.76],[-95.37,29.72],[-95.33,29.77]],
];
trunks.forEach((t,i)=>{
lineLyr.add(new Graphic({geometry:new Polyline({paths:[t]}),symbol:{type:"simple-line",color:i<2?[26,188,156,160]:[155,89,182,120],width:i<2?2.5:1.5}}));
});
});

// ===== SCRIPTED RESPONSES =====
const chipSets={
initial:["üåä Investigate Brays Bayou overflow cascade","üî¥ Show all SSO risk locations","üí∞ What's our total flood exposure?","üèóÔ∏è Manhole & pipe inventory summary","‚öôÔ∏è Lift station status across network","üìä Catchment capacity ranking"],
cascade:["Which neighborhoods flood first?","Show downstream contamination risk","üí∞ What's our total flood exposure?","Generate emergency work order","Regulatory notification (TCEQ)","‚Ü©Ô∏è Return to overview"],
sso:["Show downstream contamination risk","Regulatory notification (TCEQ)","üí∞ What's our total flood exposure?","‚Ü©Ô∏è Return to overview"],
operations:["Regulatory notification (TCEQ)","‚öôÔ∏è Lift station status across network","üìä Catchment capacity ranking","‚Ü©Ô∏è Return to overview"],
assets:["üèóÔ∏è Manhole & pipe inventory summary","üìä Catchment capacity ranking","‚öôÔ∏è Lift station status across network","‚Ü©Ô∏è Return to overview"]
};

const R={
"investigate brays bayou overflow cascade":{
content:`<p><strong>üåä BRAYS BAYOU TRUNK ‚Äî CRITICAL CASCADE OVERFLOW</strong></p>
<div class="vb"><div class="vt">Overflow Status ‚Äî MH-101 (Brays Bayou Trunk)</div>
<div class="vr"><span class="l">Current Flow</span><span class="v red">127% of design capacity</span></div>
<div class="vr"><span class="l">Water Surface Elevation</span><span class="v red">14.2 ft (rim at 14.8 ft)</span></div>
<div class="vr"><span class="l">Surcharge Status</span><span class="v red">SURCHARGING ‚Äî 0.6 ft to street overflow</span></div>
<div class="vr"><span class="l">Rainfall Intensity</span><span class="v red">3.2 in/hr (1-hr 100-yr intensity)</span></div>
<div class="vr"><span class="l">Upstream Catchment</span><span class="v">42 sq mi ‚Äî Meyerland, Bellaire, Westbury</span></div>
<div class="vr"><span class="l">Pipe Diameter</span><span class="v">96" RCP (1987, 38 years old)</span></div>
<div class="vr"><span class="l">Condition Rating</span><span class="v amb">3 (Fair ‚Äî root intrusion, joint separation)</span></div>
</div>
<p><strong>Cascade sequence if MH-101 overflows:</strong></p>
<div class="vb"><div class="vt">Cascade Timeline</div>
<div class="vr"><span class="l">T+0 min</span><span class="v red">MH-101 surcharges to street ‚Üí Brays Bayou Blvd flooding</span></div>
<div class="vr"><span class="l">T+12 min</span><span class="v red">MH-204 (Sims Bayou) overtops ‚Äî backwater effect</span></div>
<div class="vr"><span class="l">T+20 min</span><span class="v red">Combined flow overwhelms MH-312 (Buffalo junction)</span></div>
<div class="vr"><span class="l">T+25 min</span><span class="v amb">4 SSO points activate ‚Äî raw sewage enters bayou</span></div>
<div class="vr"><span class="l">T+45 min</span><span class="v amb">Westpark Lift Station LS-01 overwhelmed ‚Üí emergency bypass</span></div>
<div class="vr"><span class="l">T+2 hrs</span><span class="v amb">69th St WWTP headworks at 140% ‚Äî partial bypass to bayou</span></div>
<div class="vr"><span class="l">T+4 hrs</span><span class="v red">EPA Consent Decree violation triggered</span></div>
</div>
<p><div class="vb"><div class="vt">Early Warning Evidence</div>
<div class="vr"><span class="l">Signal</span><span class="v">Upstream inflow rate-of-rise: +2.8 ft¬≥/s/min vs catchment model</span></div>
<div class="vr"><span class="l">Source</span><span class="v">NWS QPE Radar + upstream USGS gauges + I&I infiltration model</span></div>
<div class="vr"><span class="l">Level Sensor Alarm</span><span class="v">Triggers at 14.0 ft (rim depth). Currently 14.2 ft ‚Äî already past alarm.</span></div>
<div class="vr"><span class="l">Nexus Flagged At</span><span class="v amb">11.8 ft (45 min ago) ‚Äî inflow acceleration exceeded catchment response bounds</span></div>
<div class="vr"><span class="l">Confidence</span><span class="v">91% ‚Äî validated against radar QPE nowcast + historical I&I model</span></div>
</div>
<p>Nexus detected upstream flow acceleration <strong>45 minutes before</strong> level sensors alarmed ‚Äî when diversion to the detention basin was still feasible.</p></p>
<div class="prov"><div class="prov-l">Data Sources</div><div class="prov-t"><span class="pt">SCADA Level Sensors</span><span class="pt">USGS Stream Gauges</span><span class="pt">NWS QPE Radar</span><span class="pt">Esri Sewer GIS</span></div></div>`,
chips:chipSets.cascade},

"which neighborhoods flood first":{
content:`<p><strong>FLOOD SEQUENCE ‚Äî Neighborhood Impact Analysis</strong></p>
<div class="vb"><div class="vt">Network Trace: MH-101 Overflow ‚Üí Street Flooding</div>
<div class="trace">
<span class="tn src">MH-101 (127%)</span><span class="ta">‚Üí</span>
<span class="tn mid">Brays Bayou Blvd</span><span class="ta">‚Üí</span>
<span class="tn mid">Bellaire Blvd</span><span class="ta">‚Üí</span>
<span class="tn mid">S. Rice Ave</span><span class="ta">‚Üí</span>
<span class="tn end">Meyerland Plaza</span>
</div></div>
<div class="vb"><div class="vt">Impact by Neighborhood (sorted by time to flood)</div>
<table class="vtbl">
<tr><th>Neighborhood</th><th>Pop.</th><th>Flood Time</th><th>Depth (est.)</th><th>Properties</th></tr>
<tr><td class="hl" style="color:var(--red)">Meyerland</td><td>12,400</td><td style="color:var(--red)">T+15 min</td><td>18-24 in</td><td>3,200 homes</td></tr>
<tr><td class="hl" style="color:var(--red)">Westbury</td><td>38,700</td><td style="color:var(--red)">T+25 min</td><td>12-18 in</td><td>8,400 homes</td></tr>
<tr><td class="hl" style="color:var(--amb)">Bellaire</td><td>18,200</td><td style="color:var(--amb)">T+35 min</td><td>6-12 in</td><td>4,100 homes</td></tr>
<tr><td>Braeswood</td><td>8,900</td><td>T+45 min</td><td>6-10 in</td><td>2,300 homes</td></tr>
<tr><td>Willowbend</td><td>5,600</td><td>T+60 min</td><td>4-8 in</td><td>1,400 homes</td></tr>
</table></div>
<p><strong>Summary:</strong> 83,800 residents at risk. 19,400 residential properties. First responders need to focus on Meyerland ‚Äî it floods first and deepest. Estimated property damage: <strong>$8.2M</strong> if no intervention.</p>
<div class="prov"><div class="prov-l">Data Sources</div><div class="prov-t"><span class="pt">Esri Sewer GIS</span><span class="pt">Census/ACS</span><span class="pt">FEMA Flood Maps</span><span class="pt">Harris CAD</span></div></div>`,
chips:chipSets.cascade},

"show downstream contamination risk":{
content:`<p><strong>üî¥ CONTAMINATION CASCADE ‚Äî SSO to Waterway Impact</strong></p>
<div class="vb"><div class="vt">Sanitary Sewer Overflow Projections</div>
<div class="vr"><span class="l">SSO-1 (Bellaire Blvd)</span><span class="v red">Est. 340,000 gallons</span></div>
<div class="vr"><span class="l">SSO-2 (South Main)</span><span class="v red">Est. 520,000 gallons</span></div>
<div class="vr"><span class="l">SSO-3 (Telephone Rd)</span><span class="v amb">Est. 180,000 gallons</span></div>
<div class="vr"><span class="l">SSO-4 (Navigation Blvd)</span><span class="v amb">Est. 95,000 gallons</span></div>
<div class="vr" style="border-top:1px solid var(--brd);padding-top:4px;margin-top:4px"><span class="l" style="font-weight:700;color:var(--t1)">TOTAL SSO VOLUME</span><span class="v red">1,135,000 gallons</span></div>
</div>
<div class="vb"><div class="vt">Affected Waterways</div>
<div class="vr"><span class="l">Brays Bayou</span><span class="v red">Direct SSO discharge ‚Äî E. coli spike expected</span></div>
<div class="vr"><span class="l">Sims Bayou</span><span class="v amb">Indirect via tributary ‚Äî 2-hour travel time</span></div>
<div class="vr"><span class="l">Buffalo Bayou</span><span class="v amb">Downstream from junction ‚Äî 4-hour travel time</span></div>
<div class="vr"><span class="l">Houston Ship Channel</span><span class="v">Ultimate receiving water ‚Äî 8-12 hours</span></div>
</div>
<p><strong>Regulatory implications:</strong> Any SSO >10,000 gallons triggers mandatory TCEQ 24-hour notification. Four simultaneous SSOs exceeding 1M gallons total will trigger EPA Consent Decree review. Last similar event: Hurricane Harvey (2017).</p>`,
chips:chipSets.sso},

"show all sso risk locations":{
content:`<p><strong>üî¥ SANITARY SEWER OVERFLOW ‚Äî 4 Active Risk Locations</strong></p>
<div class="vb"><div class="vt">SSO Risk Assessment (sorted by urgency)</div>
<table class="vtbl">
<tr><th>Location</th><th>Cause</th><th>Est. Volume</th><th>Time to SSO</th><th>Waterway</th></tr>
<tr><td class="hl" style="color:var(--red)">SSO-2: South Main</td><td>I&I + surcharge</td><td style="color:var(--red)">520K gal</td><td style="color:var(--red)">Active NOW</td><td>Sims Bayou</td></tr>
<tr><td class="hl" style="color:var(--red)">SSO-1: Bellaire Blvd</td><td>Trunk overflow</td><td style="color:var(--red)">340K gal</td><td style="color:var(--red)">~8 min</td><td>Brays Bayou</td></tr>
<tr><td class="hl" style="color:var(--amb)">SSO-3: Telephone Rd</td><td>Lift station backup</td><td style="color:var(--amb)">180K gal</td><td style="color:var(--amb)">~25 min</td><td>Sims Bayou</td></tr>
<tr><td class="hl">SSO-4: Navigation Blvd</td><td>Junction overflow</td><td>95K gal</td><td>~45 min</td><td>Buffalo Bayou</td></tr>
</table></div>
<p><strong>I&I (Inflow & Infiltration)</strong> is the primary driver ‚Äî aging pipes with joint failures and root intrusion are letting stormwater into the sanitary system. This 96" trunk was installed in 1987 and has a condition rating of 3 (Fair). CCTV inspection in 2023 found 47 defects across 12,000 linear feet.</p>
<div class="prov"><div class="prov-l">Data Sources</div><div class="prov-t"><span class="pt">SCADA Level Sensors</span><span class="pt">Esri Sewer GIS</span><span class="pt">NASSCO CCTV</span><span class="pt">I&I Model</span></div></div>`,
chips:chipSets.sso},

"whats our total flood exposure":{
content:`<p><strong>üí∞ TOTAL FLOOD EXPOSURE ‚Äî Houston Sewer/Stormwater Event</strong></p>
<div class="vb"><div class="vt">Financial Impact Breakdown</div>
<div class="vr"><span class="l">Residential Property Damage</span><span class="v red">$5.8M</span></div>
<div class="vr"><span class="l">Commercial/Industrial Damage</span><span class="v red">$2.4M</span></div>
<div class="vr"><span class="l">Emergency Response & Cleanup</span><span class="v amb">$1.2M</span></div>
<div class="vr"><span class="l">SSO Remediation & Disinfection</span><span class="v amb">$0.8M</span></div>
<div class="vr"><span class="l">TCEQ Regulatory Penalties</span><span class="v amb">$1.4M</span></div>
<div class="vr"><span class="l">EPA Consent Decree Fine (if triggered)</span><span class="v red">$2-3M (est.)</span></div>
<div class="vr"><span class="l">Infrastructure Repair (pipe, manholes)</span><span class="v">$0.9M</span></div>
<div class="vr" style="border-top:1px solid var(--brd);padding-top:6px;margin-top:4px"><span class="l" style="font-weight:700;color:var(--t1)">DIRECT EXPOSURE</span><span class="v red" style="font-size:14px">$12.4M</span></div>
<div class="vr"><span class="l" style="font-style:italic">+ EPA Consent Decree (if triggered)</span><span class="v red" style="font-style:italic">$2.5M</span></div>
<div class="vr"><span class="l" style="font-weight:700;color:var(--t1)">WORST-CASE TOTAL</span><span class="v red" style="font-size:14px">$15.0M</span></div>
</div>
<div class="vb"><div class="vt">Proactive Mitigation Cost</div>
<div class="vr"><span class="l">Emergency diversion to Westpark detention basin</span><span class="v grn">$120K</span></div>
<div class="vr"><span class="l">Deploy 3 bypass pumps to SSO-1 and SSO-2</span><span class="v grn">$85K</span></div>
<div class="vr"><span class="l">Emergency crew deployment (4 teams)</span><span class="v grn">$65K</span></div>
<div class="vr" style="border-top:1px solid var(--brd);padding-top:6px;margin-top:4px"><span class="l" style="font-weight:700;color:var(--t1)">TOTAL MITIGATION</span><span class="v grn">$270K</span></div>
</div>
<p><strong>Net protection:</strong> $270K spent protects $10.2M in damages. <strong>ROI: 38:1</strong>. Remaining $4.8M is residual from rain intensity exceeding all available capacity.</p>`,
chips:chipSets.cascade},

"manhole pipe inventory summary":{
content:`<p><strong>üèóÔ∏è SEWER ASSET INVENTORY ‚Äî Southeast Service District (Pilot Area)</strong></p>
<div class="vb"><div class="vt">Manholes (from Sewer GIS ‚Äî wManhole)</div>
<table class="vtbl">
<tr><th>Type</th><th>Count</th><th>Avg Age</th><th>Avg Depth</th></tr>
<tr><td class="hl">Standard</td><td>14,234</td><td>28 yr</td><td>8.4 ft</td></tr>
<tr><td class="hl">Junction</td><td>1,847</td><td>32 yr</td><td>12.1 ft</td></tr>
<tr><td>Drop</td><td>567</td><td>25 yr</td><td>14.8 ft</td></tr>
<tr><td>Diversion</td><td>89</td><td>18 yr</td><td>10.2 ft</td></tr>
<tr style="border-top:1px solid var(--brd)"><td class="hl">TOTAL</td><td class="hl">16,737</td><td>28.5 yr</td><td>9.1 ft</td></tr>
</table></div>
<div class="vb"><div class="vt">Gravity Mains (from wGravityMain)</div>
<table class="vtbl">
<tr><th>Diameter</th><th>Length (mi)</th><th>Material</th><th>Avg Age</th></tr>
<tr><td>8"</td><td>456</td><td>VCP/PVC</td><td>22 yr</td></tr>
<tr><td>12-15"</td><td>234</td><td>RCP/VCP</td><td>30 yr</td></tr>
<tr><td>18-24"</td><td>156</td><td>RCP</td><td>32 yr</td></tr>
<tr><td>30-48"</td><td>89</td><td>RCP</td><td>35 yr</td></tr>
<tr><td>54-96" (Trunks)</td><td>34</td><td>RCP</td><td>38 yr</td></tr>
<tr style="border-top:1px solid var(--brd)"><td class="hl">TOTAL</td><td class="hl">969 mi</td><td>‚Äî</td><td>27 yr</td></tr>
</table></div>
<div class="vb"><div class="vt">Condition Ratings (NASSCO PACP)</div>
<div class="vr"><span class="l">Grade 1 (Excellent)</span><span class="v grn">12% ‚Äî 116 mi</span></div>
<div class="vr"><span class="l">Grade 2 (Good)</span><span class="v grn">28% ‚Äî 271 mi</span></div>
<div class="vr"><span class="l">Grade 3 (Fair)</span><span class="v amb">34% ‚Äî 329 mi</span></div>
<div class="vr"><span class="l">Grade 4 (Poor)</span><span class="v amb">18% ‚Äî 174 mi</span></div>
<div class="vr"><span class="l">Grade 5 (Immediate attention)</span><span class="v red">8% ‚Äî 78 mi ‚ö†Ô∏è</span></div>
</div>
<p>78 miles of sewer main require immediate rehabilitation or replacement. These Grade 5 segments are the primary I&I contributors driving today's SSO events.</p>`,
chips:chipSets.assets},

"lift station status across network":{
content:`<p><strong>‚öôÔ∏è LIFT STATION STATUS ‚Äî All 22 Stations</strong></p>
<div class="vb"><div class="vt">Station Status Summary</div>
<table class="vtbl">
<tr><th>Station</th><th>Capacity %</th><th>Pumps</th><th>Status</th><th>Wet Well</th></tr>
<tr><td class="hl" style="color:var(--amb)">LS-01 Westpark</td><td style="color:var(--amb)">92%</td><td>3/3 running</td><td style="color:var(--amb)">STRESSED</td><td>High alarm</td></tr>
<tr><td class="hl" style="color:var(--amb)">LS-02 Almeda</td><td style="color:var(--amb)">88%</td><td>2/2 running</td><td style="color:var(--amb)">STRESSED</td><td>High alarm</td></tr>
<tr><td>LS-03 Hobby Airport</td><td>64%</td><td>2/3 running</td><td style="color:var(--grn)">NORMAL</td><td>Normal</td></tr>
<tr><td>LS-04 Clear Lake</td><td>71%</td><td>2/3 running</td><td style="color:var(--grn)">NORMAL</td><td>Normal</td></tr>
<tr><td>LS-05 Spring Branch</td><td>58%</td><td>1/2 running</td><td style="color:var(--grn)">NORMAL</td><td>Normal</td></tr>
</table></div>
<p><strong>Key risk:</strong> LS-01 (Westpark) is running all 3 pumps at 92% ‚Äî no redundancy. If any pump fails during this event, immediate overflow. LS-02 similar risk. Both stations serve the highest-impact trunk lines feeding the Brays Bayou overflow area.</p>
<p>Remaining 17 stations operating normally (45-75% capacity).</p>`,
chips:chipSets.operations},

"generate emergency work order":{
content:`<p><strong>üìã WORK ORDER GENERATED</strong></p>
<div class="wo"><div class="wo-h">WO-2025-STORM-1847 ‚Äî EMERGENCY</div>
<div class="wo-f"><span class="wl">Asset</span><span class="wv">MH-101 (Brays Bayou Trunk), MH-204, MH-312</span></div>
<div class="wo-f"><span class="wl">Issue</span><span class="wv">Surcharged manholes ‚Äî overflow imminent / active</span></div>
<div class="wo-f"><span class="wl">Priority</span><span class="wv" style="color:var(--red)">P1 ‚Äî EMERGENCY</span></div>
<div class="wo-f"><span class="wl">Description</span><span class="wv">1-hr 100-yr rainfall event (3.2 in/hr). 3 manholes surcharged >85% rim depth. 4 SSO locations at risk. Cascade to WWTP headworks.</span></div>
<div class="wo-f"><span class="wl">Crew</span><span class="wv">Emergency Response Team A + B (12 persons)</span></div>
<div class="wo-f"><span class="wl">Equipment</span><span class="wv">3√ó bypass pumps, traffic barriers, portable generators, vac truck</span></div>
<div class="wo-f"><span class="wl">Regulatory</span><span class="wv">TCEQ 24-hr SSO notification required if SSO >10K gal</span></div>
<div class="wo-f"><span class="wl">Est. Duration</span><span class="wv">8-12 hours (weather dependent)</span></div>
</div>
<p>Work order synced to Cityworks. TCEQ notification template pre-populated and ready for supervisor approval.</p>`,
chips:chipSets.operations},

"regulatory notification tceq":{
content:`<p><strong>üìã TCEQ SSO NOTIFICATION ‚Äî Pre-Populated</strong></p>
<div class="vb" style="border-color:rgba(155,89,182,.3);background:rgba(155,89,182,.05)">
<div class="vt" style="color:var(--purp)">TCEQ SSO Notification ‚Äî SSO Notification (24-Hour)</div>
<div class="vr"><span class="l">Permitted Entity</span><span class="v">City of Houston ‚Äî WW Permit TX00XXXXX</span></div>
<div class="vr"><span class="l">Date/Time of SSO</span><span class="v">[AUTO-POPULATED FROM SCADA]</span></div>
<div class="vr"><span class="l">Duration</span><span class="v">Ongoing ‚Äî est. 4-8 hours</span></div>
<div class="vr"><span class="l">SSO Locations</span><span class="v">4 locations (Bellaire, S. Main, Telephone, Navigation)</span></div>
<div class="vr"><span class="l">Estimated Volume</span><span class="v red">1,135,000 gallons (combined)</span></div>
<div class="vr"><span class="l">Cause</span><span class="v">Extreme rainfall (3.2 in/hr, 1-hr 100-yr) exceeding system capacity; I&I through aging infrastructure</span></div>
<div class="vr"><span class="l">Receiving Waters</span><span class="v">Brays Bayou, Sims Bayou, Buffalo Bayou</span></div>
<div class="vr"><span class="l">Corrective Actions</span><span class="v">Bypass pumping deployed, diversion activated, emergency crews on-site</span></div>
<div class="vr"><span class="l">Public Notification</span><span class="v">Posted at SSO locations, downstream public areas</span></div>
</div>
<p>Form pre-populated from real-time SCADA and GIS data. Requires supervisor digital signature before submission via TCEQ STEERS portal. <strong>Deadline: 24 hours from SSO start.</strong></p>`,
chips:chipSets.sso},

"catchment capacity ranking":{
content:`<p><strong>üìä CATCHMENT CAPACITY ‚Äî Ranked by Stress Level</strong></p>
<div class="vb"><div class="vt">Top 10 Catchments (sorted by % capacity used)</div>
<table class="vtbl">
<tr><th>#</th><th>Catchment</th><th>Area (mi¬≤)</th><th>Capacity %</th><th>Pop.</th><th>SSO Risk</th></tr>
<tr><td>1</td><td class="hl" style="color:var(--red)">Brays Bayou Upper</td><td>42</td><td style="color:var(--red)">127%</td><td>84K</td><td style="color:var(--red)">ACTIVE</td></tr>
<tr><td>2</td><td class="hl" style="color:var(--red)">Sims Bayou Central</td><td>28</td><td style="color:var(--red)">134%</td><td>56K</td><td style="color:var(--red)">ACTIVE</td></tr>
<tr><td>3</td><td class="hl" style="color:var(--red)">Buffalo Bayou Junction</td><td>18</td><td style="color:var(--red)">145%</td><td>32K</td><td style="color:var(--red)">ACTIVE</td></tr>
<tr><td>4</td><td class="hl" style="color:var(--amb)">Westpark</td><td>15</td><td style="color:var(--amb)">92%</td><td>24K</td><td style="color:var(--amb)">HIGH</td></tr>
<tr><td>5</td><td style="color:var(--amb)">Almeda</td><td>12</td><td style="color:var(--amb)">88%</td><td>18K</td><td style="color:var(--amb)">HIGH</td></tr>
<tr><td>6</td><td>Meyerland</td><td>8</td><td>87%</td><td>12K</td><td>MODERATE</td></tr>
<tr><td>7</td><td>Galleria</td><td>6</td><td>55%</td><td>28K</td><td style="color:var(--grn)">LOW</td></tr>
<tr><td>8</td><td>Hobby Airport</td><td>14</td><td>64%</td><td>22K</td><td style="color:var(--grn)">LOW</td></tr>
</table></div>
<p>The top 3 catchments are all exceeding 100% design capacity ‚Äî this is the cascading failure zone. Each drains into the other, compounding the problem downstream.</p>`,
chips:chipSets.cascade},

"return to overview":{
content:`<p>Back to the main dashboard. Storm conditions remain active:</p>
<div class="vb"><div class="vt">Current Status</div>
<div class="vr"><span class="l">Active Overflows</span><span class="v red">3 manholes</span></div>
<div class="vr"><span class="l">SSO Risk Points</span><span class="v amb">4 locations (1 active, 3 imminent)</span></div>
<div class="vr"><span class="l">Total Exposure</span><span class="v red">$12.4M</span></div>
<div class="vr"><span class="l">Rainfall Forecast</span><span class="v">2.8 in/hr next 2 hours, then diminishing</span></div>
</div><p>What would you like to investigate?</p>`,
chips:chipSets.initial}
};

// ===== ENGINE =====
let isProc=false;
function norm(t){return t.toLowerCase().replace(/[^\w\s]/g,'').replace(/\s+/g,' ').trim()}
function find(t){
const n=norm(t);
for(const[k,v]of Object.entries(R)){if(n===k||n.includes(k)||k.includes(n))return v}
if(n.includes('brays')||n.includes('cascade')||n.includes('overflow'))return R['investigate brays bayou overflow cascade'];
if(n.includes('sso')||n.includes('sanitary'))return R['show all sso risk locations'];
if(n.includes('neighborhood')||n.includes('flood first'))return R['which neighborhoods flood first'];
if(n.includes('contaminat')||n.includes('downstream'))return R['show downstream contamination risk'];
if(n.includes('financial')||n.includes('exposure')||n.includes('cost')||n.includes('dollar'))return R['whats our total flood exposure'];
if(n.includes('manhole')||n.includes('pipe')||n.includes('inventory'))return R['manhole pipe inventory summary'];
if(n.includes('lift')||n.includes('pump')||n.includes('station'))return R['lift station status across network'];
if(n.includes('work order'))return R['generate emergency work order'];
if(n.includes('tceq')||n.includes('regulatory')||n.includes('epa'))return R['regulatory notification tceq'];
if(n.includes('catchment')||n.includes('capacity')||n.includes('ranking'))return R['catchment capacity ranking'];
if(n.includes('overview')||n.includes('return')||n.includes('back'))return R['return to overview'];
return null;
}
function scroll(){setTimeout(()=>{document.getElementById('chatMessages').scrollTop=document.getElementById('chatMessages').scrollHeight},10)}
function addMsg(c,u=false){
const el=document.getElementById('chatMessages'),m=document.createElement('div');
m.className=`msg ${u?'u':'a'}`;
m.innerHTML=`<div class="mb">${u?DOMPurify.sanitize(c):DOMPurify.sanitize(c,{ALLOWED_TAGS:['div','span','strong','em','br','p','b','i','table','tr','td','th','thead','tbody'],ALLOWED_ATTR:['class','style','colspan']})}</div>`;
el.appendChild(m);scroll();
}
function showTyp(){const el=document.getElementById('chatMessages'),m=document.createElement('div');m.className='msg a';m.id='typ';m.innerHTML='<div class="mb"><div class="td"><div class="tdt"></div><div class="tdt"></div><div class="tdt"></div></div></div>';el.appendChild(m);scroll()}
function hideTyp(){const e=document.getElementById('typ');if(e)e.remove()}
function updChips(chips){const g=document.getElementById('chipsGrid');g.innerHTML='';chips.forEach(c=>{const b=document.createElement('button');b.className='chip';if(c.includes('‚Ü©Ô∏è'))b.className+=' ov';b.textContent=c;b.onclick=()=>handle(c);g.appendChild(b)})}
function setCritical(ids){if(!window._ptLyr)return;const gs=window._ptLyr.graphics.items;ids.forEach(id=>{const g=gs.find(x=>x.attributes&&x.attributes.id===id);if(g)g.symbol={type:"simple-marker",color:[229,77,77],size:18,outline:{color:[255,255,255],width:2}}})}
function zoomTo(lon,lat,z){if(window._view)window._view.goTo({center:[lon,lat],zoom:z||12},{duration:800})}

async function handle(t){
if(isProc)return;isProc=true;addMsg(t,true);showTyp();
await new Promise(r=>setTimeout(r,400+Math.random()*400));
const resp=find(t);hideTyp();
if(resp){addMsg(resp.content);updChips(resp.chips||chipSets.initial);
const n=t.toLowerCase();
if(n.includes('cascade')||n.includes('investigate')||n.includes('brays')){{setCritical(["MH-101","MH-204","MH-312"]);zoomTo(-95.40,29.70,12)}}
else if(n.includes('sso')||n.includes('contaminat')){{setCritical(["SSO-1","SSO-2","SSO-3","SSO-4"]);zoomTo(-95.37,29.72,11)}}
else if(n.includes('overview')||n.includes('return'))zoomTo(-95.37,29.76,11);
}
else{addMsg('<p>I can investigate that area further. The current storm event has 3 active overflow points and 4 SSO risk locations. Try one of the suggested queries for detailed analysis.</p>');updChips(chipSets.initial)}
isProc=false;
}
function handleSend(){const i=document.getElementById('chatInput'),t=i.value.trim();if(!t)return;i.value='';handle(t)}
document.getElementById('chatInput').addEventListener('keydown',e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSend()}});

updChips(chipSets.initial);
addMsg(`<p><strong>üåä FLOOD EVENT ALERT ‚Äî Houston Metro Area Under Extreme Rainfall</strong></p>
<p>Nexus has detected cascading sewer and stormwater failures across southern Harris County:</p>
<div class="vb">
<div class="vr"><span class="l">Rainfall Intensity</span><span class="v red">3.2 in/hr (100-year return period)</span></div>
<div class="vr"><span class="l">Manholes Surcharged</span><span class="v red">3 critical (MH-101, MH-204, MH-312)</span></div>
<div class="vr"><span class="l">SSO Risk Points</span><span class="v amb">4 locations ‚Äî 1 active overflow</span></div>
<div class="vr"><span class="l">Total Exposure</span><span class="v red">$12.4M (property + regulatory)</span></div>
<div class="vr"><span class="l">Residents at Risk</span><span class="v">83,800 across 5 neighborhoods</span></div>
</div>
<p>This pattern was detected <strong>45 minutes before</strong> level sensors triggered ‚Äî when diversion to the Westpark detention basin was still feasible. What would you like to investigate?</p>`);
</script>
<script>
(function(){
  var PW = "stormforge";
  document.body.style.display="none";
  var o=document.createElement("div");o.id="pw-gate";
  o.innerHTML='<div style="position:fixed;top:0;left:0;width:100%;height:100%;background:#0a0e1a;display:flex;align-items:center;justify-content:center;z-index:99999;font-family:-apple-system,BlinkMacSystemFont,sans-serif"><div style="text-align:center;max-width:380px;padding:40px"><div style="font-size:28px;font-weight:700;color:#fff;margin-bottom:8px">NEXUS <span style=\'color:#00d4aa\'>INTELLIGENCE</span></div><div style="font-size:13px;color:#64748b;margin-bottom:32px">Authorized access only</div><input id="pw-input" type="password" placeholder="Enter access code" style="width:100%;padding:14px 18px;background:#111827;border:1px solid #1e293b;border-radius:8px;color:#fff;font-size:15px;outline:none;margin-bottom:16px;box-sizing:border-box" autofocus><button id="pw-btn" style="width:100%;padding:14px;background:#00d4aa;color:#0a0e1a;border:none;border-radius:8px;font-size:15px;font-weight:600;cursor:pointer">Access Demo</button><div id="pw-err" style="color:#ef4444;font-size:13px;margin-top:12px;display:none">Invalid access code</div><div style="font-size:11px;color:#334155;margin-top:24px">&copy; 2026 Rebirth Nexus Inc.</div></div></div>';
  document.documentElement.appendChild(o);
  var s=document.createElement("style");s.textContent="@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-8px)}75%{transform:translateX(8px)}}";document.head.appendChild(s);
  function go(){if(document.getElementById("pw-input").value===PW){o.remove();document.body.style.display=""}else{var e=document.getElementById("pw-err");e.style.display="block";var i=document.getElementById("pw-input");i.style.borderColor="#ef4444";i.style.animation="shake 0.5s";setTimeout(function(){i.style.animation="";i.style.borderColor="#1e293b";e.style.display="none"},2000)}}
  document.getElementById("pw-btn").addEventListener("click",go);
  document.getElementById("pw-input").addEventListener("keydown",function(e){if(e.key==="Enter")go()});
})();
</script>
</body>
</html>
